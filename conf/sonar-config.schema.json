{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://github.com/okorach/sonar-tools/tree/master/conf/sonar-config.schema.json",
  "title": "SonarConfig",
  "description": "JSON schema for SonarQube native configuration export",
  "type": "object",
  "required": ["platform", "globalSettings", "rules"],
  "properties": {
    "platform": {
        "type": "object",
        "description": "Platform information",
        "required": ["edition", "url", "version", "serverId"],
        "exclusiveMinimum": 1,
        "properties": {
            "edition": {
                "description": "The SonarQube Edition, community, developer, enterprise or sonarcloud",
                "type": "string"
            },
            "url": {
                "description": "The SonarQube platform URL",
                "type": "string",
                "format": "uri"
            },
            "version": {
                "description": "The SonarQube version",
                "type": "string"
            },
            "serverId": {
                "description": "The SonarQube server id",
                "type": "string"
            },
            "plugins": {
                "description": "The list of plugins installed on the instance",
                "type": "array",
                "exclusiveMinimum": 0,
                "items": {
                    "type": "object",
                    "required": ["key", "version", "name"],
                    "properties": {
                        "key": {
                            "description": "The plugin key",
                            "type": "string"
                        },
                        "version": {
                            "description": "The plugin version",
                            "type": "string"
                        },
                        "name": {
                            "description": "The plugin name",
                            "type": "string"
                        }
                    }
                }
            }
        }
    },
    "globalSettings": {
        "type": "object",
        "exclusiveMinimum": 1,
        "description": "Global SonarQube settings",
        "required": ["generalSettings", "languages"],
        "properties": {
            "generalSettings": {
                "type": "array",
                "description": "General configuration settings",
                "items": {
                    "type": "object",
                    "required": ["key", "value"],
                    "properties": {
                        "key": {
                            "type": "string",
                            "description": "Setting key"
                        },
                        "value": {
                            "type": "string",
                            "description": "Setting value"
                        }
                    }
                }
            },
            "analysisScope": {
                "type": "array",
                "description": "Analysis scope settings",
                "items": {
                    "type": "object",
                    "required": ["key", "value"],
                    "properties": {
                        "key": {
                            "type": "string",
                            "description": "Setting key"
                        },
                        "value": {
                            "type": "string",
                            "description": "Setting value"
                        }
                    }
                }
            },
            "authentication": {
                "type": "array",
                "description": "Authentication settings",
                "items": {
                    "type": "object",
                    "required": ["key", "value"],
                    "properties": {
                        "key": {
                            "type": "string",
                            "description": "Setting key"
                        },
                        "value": {
                            "type": "string",
                            "description": "Setting value"
                        }
                    }
                }
            },
            "devopsIntegration": {
                "type": "array",
                "description": "Devops integration settings",
                "items": {
                    "type": "object",
                    "required": ["key", "value"],
                    "properties": {
                        "key": {
                            "type": "string",
                            "description": "Setting key"
                        },
                        "value": {
                            "type": "string",
                            "description": "Setting value"
                        }
                    }
                }
            },
            "sastConfig": {
                "type": "array",
                "description": "SAST configuration settings",
                "items": {
                    "type": "object",
                    "required": ["key", "value"],
                    "properties": {
                        "key": {
                            "type": "string",
                            "description": "Setting key"
                        },
                        "value": {
                            "type": "string",
                            "description": "Setting value"
                        }
                    }
                }
            },
            "linters": {
                "type": "array",
                "description": "Linter settings",
                "items": {
                    "type": "object",
                    "required": ["key", "value"],
                    "properties": {
                        "key": {
                            "type": "string",
                            "description": "Setting key"
                        },
                        "value": {
                            "type": "string",
                            "description": "Setting value"
                        }
                    }
                }
            },
            "thirdParty": {
                "type": "array",
                "description": "Third party settings",
                "items": {
                    "type": "object",
                    "required": ["key", "value"],
                    "properties": {
                        "key": {
                            "type": "string",
                            "description": "Setting key"
                        },
                        "value": {
                            "type": "string",
                            "description": "Setting value"
                        }
                    }
                }
            },
            "permissions": {
                "type": "array",
                "description": "Permissions settings",
                "items": {
                    "oneOf": [
                        {
                            "type": "object",
                            "required": ["group", "permissions"],
                            "properties": {
                                "group": {
                                    "type": "string",
                                    "description": "The group name"
                                },
                                "permissions": {
                                    "type": "array",
                                    "description": "List of permissions",
                                    "items": {
                                        "type": "string",
                                        "enum": [
                                            "admin",
                                            "applicationcreator",
                                            "gateadmin",
                                            "portfoliocreator",
                                            "profileadmin",
                                            "provisioning",
                                            "scan"
                                        ]
                                    }
                                }
                            }
                        },
                        {
                            "type": "object",
                            "required": ["user", "permissions"],
                            "properties": {
                                "user": {
                                    "type": "string",
                                    "description": "The user login"
                                },
                                "permissions": {
                                    "type": "array",
                                    "description": "List of permissions",
                                    "items": {
                                        "type": "string",
                                        "enum": [
                                            "admin",
                                            "applicationcreator",
                                            "gateadmin",
                                            "portfoliocreator",
                                            "profileadmin",
                                            "provisioning",
                                            "scan"
                                        ]
                                    }
                                }
                            }
                        }
                    ]
                }
            },
            "languages": {
                "type": "array",
                "description": "Language-specific settings",
                "items": {
                    "type": "object",
                    "required": ["language", "settings"],
                    "properties": {
                        "language": {
                            "type": "string",
                            "description": "Programming language identifier"
                        },
                        "settings": {
                            "type": "array",
                            "description": "Language-specific settings",
                            "items": {
                                "type": "object",
                                "required": ["key", "value"],
                                "properties": {
                                    "key": {
                                        "type": "string",
                                        "description": "Setting key"
    },
                                    "value": {
                                        "type": "string",
                                        "description": "Setting value"
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }
    },
    "qualityGates": {
        "type": "object",
        "description": "The list of quality gates",
        "required": ["name", "conditions"],
        "properties": {
            "name": {
                "type": "string",
                "description": "The quality gate name"
            },
            "conditions": {
                "type": "array",
                "description": "The quality gate conditions",
                "items": {
                    "type": "string"
                }
            },
            "isDefault": {
                "type": "boolean",
                "description": "Whether this quality gate is the default one"
            },
            "isBuiltIn": {
                "type": "boolean",
                "description": "Whether this quality gate is built-in"
            }
        }
    },
    "qualityProfiles": {
        "type": "array",
        "description": "The list of quality profiles organized by language",
        "items": {
            "type": "object",
            "required": ["language", "profiles"],
            "properties": {
                "language": {
                    "type": "string",
                    "description": "The programming language identifier"
                },
                "profiles": {
                    "type": "array",
                    "description": "List of quality profiles for this language",
                    "items": {
                        "$ref": "#/$defs/qualityProfile"
                    }
                }
            }
        }
    },
    "projects": {
        "type": "array",
        "description": "The list of projects",
        "items": {
            "type": "object",
            "required": ["key", "name"],
            "properties": {
                "key": {
                    "type": "string",
                    "description": "The project key"
                },
                "name": {
                    "type": "string",
                    "description": "The project name"
                },
                "visibility": {
                    "type": "string",
                    "enum": ["public", "private"],
                    "description": "The project visibility (public or private)"
                },
                "permissions": {
                    "type": "array",
                    "description": "Project permissions",
                    "items": {
                        "oneOf": [
                            {
                                "type": "object",
                                "required": ["group", "permissions"],
                                "properties": {
                                    "group": {
                                        "type": "string",
                                        "description": "The group name"
                                    },
                                    "permissions": {
                                        "type": "array",
                                        "description": "List of permissions",
                                        "items": {
                                            "type": "string",
                                            "enum": [
                                                "user",
                                                "codeviewer",
                                                "issueadmin",
                                                "securityhotspotadmin",
                                                "scan",
                                                "admin"
                                            ]
                                        }
                                    }
                                }
                            },
                            {
                                "type": "object",
                                "required": ["user", "permissions"],
                                "properties": {
                                    "user": {
                                        "type": "string",
                                        "description": "The user login"
                                    },
                                    "permissions": {
                                        "type": "array",
                                        "description": "List of permissions",
                                        "items": {
                                            "type": "string",
                                            "enum": [
                                                "user",
                                                "codeviewer",
                                                "issueadmin",
                                                "securityhotspotadmin",
                                                "scan",
                                                "admin"
                                            ]
                                        }
                                    }
                                }
                            }
                        ]
                    }
                },
                "qualityProfiles": {
                    "type": "array",
                    "description": "Quality profiles assigned to this project",
                    "items": {
                        "type": "object",
                        "required": ["language", "name"],
                        "properties": {
                            "language": {
                                "type": "string",
                                "description": "The programming language"
                            },
                            "name": {
                                "type": "string",
                                "description": "The quality profile name"
                            }
                        }
                    }
                },
                "links": {
                    "type": "array",
                    "description": "Project links",
                    "items": {
                        "type": "object",
                        "required": ["type", "name", "url"],
                        "properties": {
                            "type": {
                                "type": "string",
                                "description": "The link type"
                            },
                            "name": {
                                "type": "string",
                                "description": "The link name"
                            },
                            "url": {
                                "type": "string",
                                "format": "uri",
                                "description": "The link URL"
                            }
                        }
                    }
                },
                "branches": {
                    "type": "array",
                    "description": "Project branches",
                    "items": {
                        "type": "object",
                        "required": ["name"],
                        "properties": {
                            "name": {
                                "type": "string",
                                "description": "The branch name"
                            },
                            "isMain": {
                                "type": "boolean",
                                "description": "Whether this is the main branch"
                            },
                            "keepWhenInactive": {
                                "type": "boolean",
                                "description": "Whether to keep this branch when inactive"
                            },
                            "newCodePeriod": {
                                "type": "string",
                                "description": "The new code period setting for this branch"
                            }
                        }
                    }
                },
                "tags": {
                    "type": "array",
                    "description": "Project tags",
                    "items": {
                        "type": "string"
                    }
                },
                "settings": {
                    "type": "array",
                    "description": "Project settings",
                    "items": {
                        "type": "object",
                        "required": ["key", "value"],
                        "properties": {
                            "key": {
                                "type": "string",
                                "description": "Setting key"
                            },
                            "value": {
                                "description": "Setting value (can be string, number, boolean, or array)"
                            }
                        }
                    }
                }
            }
        }
    },
    "applications": {
        "type": "array",
        "description": "The list of applications",
        "items": {
            "type": "object",
            "required": ["key", "name"],
            "properties": {
                "key": {
                    "type": "string",
                    "description": "The application key"
                },
                "name": {
                    "type": "string",
                    "description": "The application name"
                },
                "visibility": {
                    "type": "string",
                    "enum": ["public", "private"],
                    "description": "The application visibility (public or private)"
                },
                "branches": {
                    "type": "array",
                    "description": "Application branches",
                    "items": {
                        "type": "object",
                        "required": ["name"],
                        "properties": {
                            "name": {
                                "type": "string",
                                "description": "The branch name"
                            },
                            "isMain": {
                                "type": "boolean",
                                "description": "Whether this is the main branch"
                            },
                            "projects": {
                                "type": "array",
                                "description": "Projects in this branch",
                                "items": {
                                    "type": "object",
                                    "required": ["key"],
                                    "properties": {
                                        "key": {
                                            "type": "string",
                                            "description": "The project key"
                                        },
                                        "branch": {
                                            "type": "string",
                                            "description": "The project branch"
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                "permissions": {
                    "type": "array",
                    "description": "Application permissions",
                    "items": {
                        "oneOf": [
                            {
                                "type": "object",
                                "required": ["group", "permissions"],
                                "properties": {
                                    "group": {
                                        "type": "string",
                                        "description": "The group name"
                                    },
                                    "permissions": {
                                        "type": "array",
                                        "description": "List of permissions",
                                        "items": {
                                            "type": "string",
                                            "enum": [
                                                "user",
                                                "admin"
                                            ]
                                        }
                                    }
                                }
                            },
                            {
                                "type": "object",
                                "required": ["user", "permissions"],
                                "properties": {
                                    "user": {
                                        "type": "string",
                                        "description": "The user login"
                                    },
                                    "permissions": {
                                        "type": "array",
                                        "description": "List of permissions",
                                        "items": {
                                            "type": "string",
                                            "enum": [
                                                "user",
                                                "admin"
                                            ]
                                        }
                                    }
                                }
                            }
                        ]
                    }
                },
                "tags": {
                    "type": "array",
                    "description": "Application tags",
                    "items": {
                        "type": "string"
                    }
                }
            }
        }
    },
    "portfolios": {
        "type": "array",
        "description": "The list of portfolios",
        "items": {
            "$ref": "#/$defs/portfolio"
        }
    },
    "users": {
        "type": "array",
        "description": "The list of users",
        "items": {
            "type": "object",
            "description": "User description",
            "required": ["login", "name"],
            "properties": {
                "login": {
                    "type": "string",
                    "description": "The user login"
                },
                "name": {
                    "type": "string",
                    "description": "The user name"
                },
                "email": {
                    "type": "string",
                    "format": "email",
                    "description": "The user email"
                },
                "groups": {
                    "type": "array",
                    "description": "The user list of groups",
                    "items": {
                        "type": "string"
                    }
                },
                "scmAccounts": {
                    "type": "array",
                    "description": "The user list of SCM accounts",
                    "items": {
                        "type": "string"
                    }
                },
                "local": {
                    "type": "boolean",
                    "description": "Whether the user is local or not"
                }
            }
        }
    },
    "groups": {
        "type": "array",
        "description": "Groups defined",
        "items": {
            "type": "object",
            "required": ["name"],
            "properties": {
                "name": {
                    "type": "string",
                    "description": "The unique group name"
                },
                "description": {
                    "type": "string",
                    "description": "The group description"
                }
            }
        }
    },
    "rules": {
        "description": "List of rules that were instantiated or parameterized",
        "type": "object",
        "items": {
            "type": "object",
            "properties": {
                "instantiated": {
                    "description": "List of instantiated rules",
                    "type": "array",
                    "items": {
                        "type": "object",
                        "required": ["key", "language", "templateKey", "severity", "impacts"],
                        "properties": {
                            "key": {
                                "type": "string",
                                "description": "The rule key"
                            },
                            "language": {
                                "type": "string",
                                "description": "The rule language"
                            },
                            "templateKey": {
                                "type": "string",
                                "description": "The rule template key"
                            },
                            "severity": {
                                "type": "string",
                                "description": "Severity in Std Experience"
                            },
                            "impacts": {
                                "type": "object",
                                "description": "The rule impacts in MQR mode",
                                "properties": {
                                    "SECURITY": {
                                        "type": "string",
                                        "description": "Security impact"
                                    },
                                    "RELIABILITY": {
                                        "type": "string",
                                        "description": "Reliability impact"
                                    },
                                    "MAINTAINABILITY": {
                                        "type": "string",
                                        "description": "Maintainability impact"
                                    }
                                }
                            },
                            "params": {
                                "type": "array",
                                "description": "The rule parameters",
                                "items": {
                                    "type": "object",
                                    "required": ["key", "value"],
                                    "properties": {
                                        "key": {
                                            "type": "string",
                                            "description": "Parameter key"
                                        },
                                        "value": {
                                            "type": "string",
                                            "description": "Parameter value"
                                        }
                                    }
                                }
                            }
                        }
                    }
                },
                "extended": {
                    "description": "List of extended/customized rules",
                    "type": "array",
                    "items": {
                        "type": "object",
                        "required": ["key"],
                        "properties": {
                            "key": {
                                "type": "string",
                                "description": "The rule key"
                            },
                            "tags": {
                                "type": "array",
                                "description": "The rule language",
                                "items": {
                                    "type": "string"
                                }
                            },
                            "description": {
                                "type": "string",
                                "description": "The rule extended description"
                            }
                        }
                    }
                }
            }
        }
    }
  },
  "$defs": {
    "qualityProfile": {
      "type": "object",
      "required": ["name"],
      "properties": {
        "name": {
          "type": "string",
          "description": "The quality profile name"
        },
        "isBuiltIn": {
          "type": "boolean",
          "description": "Whether this quality profile is built-in"
        },
        "isDefault": {
          "type": "boolean",
          "description": "Whether this quality profile is the default one"
        },
        "children": {
          "type": "array",
          "description": "Child quality profiles that inherit from this one",
          "items": {
            "$ref": "#/$defs/qualityProfile"
          }
        },
        "addedRules": {
          "type": "array",
          "description": "Rules added to this quality profile from its parent profile or if a root profile",
          "items": {
            "type": "object",
            "required": ["key"],
            "properties": {
              "key": {
                "type": "string",
                "description": "The rule key"
              },
              "params": {
                "type": "array",
                "description": "Rule parameters",
                "items": {
                  "type": "object",
                  "required": ["key", "value"],
                  "properties": {
                    "key": {
                      "type": "string",
                      "description": "Parameter key"
                    },
                    "value": {
                      "type": "string",
                      "description": "Parameter value"
                    }
                  }
                }
              },
              "impacts": {
                "type": "object",
                "description": "Rule impacts in MQR mode",
                "properties": {
                  "SECURITY": {
                    "type": "string",
                    "description": "Security impact"
                  },
                  "RELIABILITY": {
                    "type": "string",
                    "description": "Reliability impact"
                  },
                  "MAINTAINABILITY": {
                    "type": "string",
                    "description": "Maintainability impact"
                  }
                }
              }
            }
          }
        },
        "removedRules": {
          "type": "array",
          "description": "Rules removed from this quality profile",
          "items": {
            "type": "object",
            "required": ["key"],
            "properties": {
              "key": {
                "type": "string",
                "description": "The rule key"
              }
            }
          }
        },
        "modifiedRules": {
          "type": "array",
          "description": "Rules modified in this quality profile",
          "items": {
            "type": "object",
            "required": ["key"],
            "properties": {
              "key": {
                "type": "string",
                "description": "The rule key"
              },
              "severity": {
                "type": "string",
                "description": "The rule severity"
              },
              "impacts": {
                "type": "object",
                "description": "Rule impacts in MQR mode",
                "properties": {
                  "SECURITY": {
                    "type": "string",
                    "description": "Security impact"
                  },
                  "RELIABILITY": {
                    "type": "string",
                    "description": "Reliability impact"
                  },
                  "MAINTAINABILITY": {
                    "type": "string",
                    "description": "Maintainability impact"
                  }
                }
              },
              "prioritized": {
                "type": "boolean",
                "description": "Whether this rule is prioritized"
              },
              "tags": {
                "type": "array",
                "description": "Rule tags",
                "items": {
                  "type": "string"
                }
              },
              "params": {
                "type": "array",
                "description": "Rule parameters",
                "items": {
                  "type": "object",
                  "required": ["key", "value"],
                  "properties": {
                    "key": {
                      "type": "string",
                      "description": "Parameter key"
                    },
                    "value": {
                      "type": "string",
                      "description": "Parameter value"
                    }
                  }
                }
              }
            }
          }
        },
        "rules": {
          "type": "array",
          "description": "Rules in this quality profile (simpler format)",
          "items": {
            "type": "object",
            "required": ["key"],
            "properties": {
              "key": {
                "type": "string",
                "description": "The rule key"
              },
              "prioritized": {
                "type": "boolean",
                "description": "Whether this rule is prioritized"
              }
            }
          }
        }
      }
    },
    "portfolio": {
      "type": "object",
      "required": ["key"],
      "properties": {
        "key": {
          "type": "string",
          "description": "The portfolio key"
        },
        "name": {
          "type": "string",
          "description": "The portfolio name"
        },
        "visibility": {
          "type": "string",
          "enum": ["public", "private"],
          "description": "The portfolio visibility (public or private)"
        },
        "portfolios": {
          "type": "array",
          "description": "Nested portfolios",
          "items": {
            "$ref": "#/$defs/portfolio"
          }
        },
        "projectSelection": {
          "type": "object",
          "description": "Project selection criteria",
          "properties": {
            "rest": {
              "type": "boolean",
              "description": "Select all remaining projects"
            },
            "regexp": {
              "type": "string",
              "description": "Regular expression pattern for project selection"
            },
            "branch": {
              "type": "string",
              "description": "Branch filter for project selection"
            },
            "manual": {
              "type": "array",
              "description": "Manually selected projects",
              "items": {
                "type": "object",
                "required": ["key"],
                "properties": {
                  "key": {
                    "type": "string",
                    "description": "The project key"
                  },
                  "branches": {
                    "type": "array",
                    "description": "Project branches",
                    "items": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          }
        },
        "byReference": {
          "type": "boolean",
          "description": "Whether this portfolio is referenced by key"
        },
        "applications": {
          "type": "array",
          "description": "Applications in this portfolio",
          "items": {
            "type": "object",
            "required": ["key"],
            "properties": {
              "key": {
                "type": "string",
                "description": "The application key"
              },
              "branches": {
                "type": "array",
                "description": "Application branches",
                "items": {
                  "type": "string"
                }
              }
            }
          }
        },
        "permissions": {
          "type": "array",
          "description": "Portfolio permissions",
          "items": {
            "oneOf": [
              {
                "type": "object",
                "required": ["group", "permissions"],
                "properties": {
                  "group": {
                    "type": "string",
                    "description": "The group name"
                  },
                  "permissions": {
                    "type": "array",
                    "description": "List of permissions",
                    "items": {
                      "type": "string",
                      "enum": [
                        "user",
                        "codeviewer",
                        "issueadmin",
                        "securityhotspotadmin",
                        "scan",
                        "admin"
                      ]
                    }
                  }
                }
              },
              {
                "type": "object",
                "required": ["user", "permissions"],
                "properties": {
                  "user": {
                    "type": "string",
                    "description": "The user login"
                  },
                  "permissions": {
                    "type": "array",
                    "description": "List of permissions",
                    "items": {
                      "type": "string",
                      "enum": [
                        "user",
                        "codeviewer",
                        "issueadmin",
                        "securityhotspotadmin",
                        "scan",
                        "admin"
                      ]
                    }
                  }
                }
              }
            ]
          }
        }
      }
    }
  }
}

